<!DOCTYPE html>
<html lang="en" dir="ltr" class="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="Product Details | DH Phone" data-fr="Détails du Produit | DH Phone" data-ar="تفاصيل المنتج | DH Phone">Product Details | DH Phone</title>
    <!-- Note: For production, consider installing Tailwind CSS locally instead of using CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="stylesheet" href="hamburger-menu.css">
    <script src="hamburger-menu.js" defer></script>
    <!-- Firebase SDK -->
    <script src="config.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = window.config.firebase;

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Make db available globally and signal ready
        window.db = db;
        window.doc = doc;
        window.getDoc = getDoc;
        window.firebaseReady = true;
        
        // Dispatch event to notify that Firebase is ready
        window.dispatchEvent(new Event('firebaseReady'));
    </script>
    <script>
        (function() {
            if (window.config && window.config.emailjs && window.config.emailjs.publicKey) {
                emailjs.init(window.config.emailjs.publicKey); // EmailJS public key from config
            } else {
                console.warn('EmailJS not configured. Please add your EmailJS public key to config.js');
            }
        })();
    </script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            light: '#2563eb', // blue-600
                            dark: '#0ea5e9',  // sky-500
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        },
                        secondary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .header-glass {
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
        .nav-link {
            position: relative;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #4f46e5;
            transition: width 0.3s ease;
        }
        .dark .nav-link::after {
            background-color: #818cf8;
        }
        .nav-link:hover::after {
            width: 100%;
        }
        .active::after {
            width: 100%;
        }
        /* RTL specific styles */
        [dir="rtl"] .ml-10 {
            margin-right: 2.5rem;
            margin-left: 0;
        }
        [dir="rtl"] .mr-3 {
            margin-left: 0.75rem;
            margin-right: 0;
        }
        [dir="rtl"] .ml-1 {
            margin-right: 0.25rem;
            margin-left: 0;
        }
        [dir="rtl"] .space-x-8 > :not([hidden]) ~ :not([hidden]) {
            --tw-space-x-reverse: 1;
        }
        [dir="rtl"] .space-x-4 > :not([hidden]) ~ :not([hidden]) {
            --tw-space-x-reverse: 1;
        }
        [dir="rtl"] .space-x-3 > :not([hidden]) ~ :not([hidden]) {
            --tw-space-x-reverse: 1;
        }
        [dir="rtl"] .left-4 {
            left: auto;
            right: 1rem;
        }
        [dir="rtl"] .left-0 {
            left: auto;
            right: 0;
        }
        [dir="rtl"] .right-0 {
            right: auto;
            left: 0;
        }
        [dir="rtl"] .text-left {
            text-align: right;
        }
        [dir="rtl"] .transform {
            transform-style: preserve-3d;
        }
        [dir="rtl"] .hover\:translate-x-1:hover {
            --tw-translate-x: -0.25rem;
        }
        
        /* Scroll and overflow fixes */
        html, body {
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 2rem;
        }
        
        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(79, 70, 229, 0.8);
            color: white;
            padding: 10px;
            border-radius: 50%;
            z-index: 1000;
            display: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .scroll-indicator:hover {
            background: rgba(79, 70, 229, 1);
            transform: translateY(-50%) scale(1.1);
        }
        
        .scroll-indicator.show {
            display: block;
        }
        /* Basic Reset & Global Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Dark mode styles for body */
        .dark body {
            background-color: #1a202c;
            color: #e2e8f0;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Dark mode styles for container */
        .dark .container {
            background-color: #1a202c;
        }

        /* Header Styles */
        header {
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Dark mode styles for header */
        .dark header {
            background-color: #2d3748;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }

        .language-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
            padding: 15px 0;
        }

        nav ul li a:hover {
            color: #007bff;
        }

        /* Main Product Section */
        .product-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 30px;
        }

        .product-images {
            flex: 1;
            min-width: 300px;
        }

        /* Ensure proper display for desktop vs mobile */
        .desktop-images {
            display: block;
        }

        .mobile-slider {
            display: none;
        }

        @media (max-width: 768px) {
            .desktop-images {
                display: none;
            }
            
            .mobile-slider {
                display: block;
            }
        }

        .main-image {
            width: 100%;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .thumbnail-images {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .thumbnail {
            width: 80px;
            height: 80px;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .thumbnail:hover, .thumbnail.active {
            border-color: #007bff;
        }

        .badge {
            background-color: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            display: inline-block;
            margin-top: 10px;
        }

        .product-info {
            flex: 1;
            min-width: 300px;
        }

        .product-title {
            font-size: 32px;
            margin-bottom: 10px;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for product title */
        .dark .product-title {
            color: #e2e8f0;
        }

        .price {
            font-size: 28px;
            color: #007bff;
            margin: 10px 0;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for price */
        .dark .price {
            color: #60a5fa;
        }

        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 20px;
            margin-left: 10px;
        }

        .rating {
            color: #ffc107;
            margin: 10px 0;
        }

        .stock-status {
            color: #28a745;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .features-list {
            margin: 20px 0;
            padding-left: 20px;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for features list */
        .dark .features-list {
            color: #e2e8f0;
        }

        .features-list li {
            margin-bottom: 8px;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for features list items */
        .dark .features-list li {
            color: #e2e8f0;
        }

        .cta-section {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .order-now-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .order-now-button:hover {
            background-color: #0056b3;
        }

        .share-options {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .share-label {
            font-weight: bold;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for share label */
        .dark .share-label {
            color: #e2e8f0;
        }

        .share-icons {
            display: flex;
            gap: 8px;
        }

        .share-icons .share-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 50%;
            color: #6c757d;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .share-icons .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .share-icons .share-btn.facebook:hover {
            background-color: #1877f2;
            border-color: #1877f2;
            color: white;
        }

        .share-icons .share-btn.tiktok:hover {
            background-color: #000000;
            border-color: #000000;
            color: white;
        }

        .share-icons .share-btn.instagram:hover {
            background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);
            border-color: #dc2743;
            color: white;
        }

        .share-icons .share-btn.whatsapp:hover {
            background-color: #25d366;
            border-color: #25d366;
            color: white;
        }



        /* Tabs */
        .tabs {
            margin: 30px 0;
        }

        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            transition: border-color 0.3s ease;
        }

        /* Dark mode styles for tab buttons container */
        .dark .tab-buttons {
            border-bottom-color: #4a5568;
        }

        .tab-button {
            padding: 15px 30px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        /* Dark mode styles for tab buttons */
        .dark .tab-button {
            color: #e2e8f0;
        }

        .dark .tab-button:hover {
            color: #60a5fa;
        }

        .tab-button.active {
            border-bottom: 3px solid #007bff;
            color: #007bff;
        }

        /* Dark mode styles for active tab button */
        .dark .tab-button.active {
            border-bottom-color: #60a5fa;
            color: #60a5fa;
        }

        .tab-content {
            padding: 20px 0;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for tab content */
        .dark .tab-content {
            color: #e2e8f0;
        }

        .specifications-table {
            width: 100%;
            border-collapse: collapse;
        }

        .specifications-table th,
        .specifications-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        /* Dark mode styles for specifications table */
        .dark .specifications-table th,
        .dark .specifications-table td {
            border-bottom-color: #4a5568;
            color: #e2e8f0;
        }

        .specifications-table th {
            background-color: #f8f9fa;
            width: 30%;
        }

        /* Dark mode styles for table headers */
        .dark .specifications-table th {
            background-color: #2d3748;
        }

        /* Related Products */
        .related-products {
            margin: 50px 0;
        }

        /* Mobile responsive for related products section */
        @media (max-width: 768px) {
            .related-products {
                margin: 30px 0;
                padding: 0 15px;
            }
        }

        @media (max-width: 480px) {
            .related-products {
                margin: 25px 0;
                padding: 0 10px;
            }
        }

        .section-title {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for section titles */
        .dark .section-title {
            color: #e2e8f0;
        }

        /* Mobile responsive for section title */
        @media (max-width: 768px) {
            .section-title {
                margin-bottom: 15px;
                font-size: 20px;
            }
        }

        @media (max-width: 480px) {
            .section-title {
                margin-bottom: 12px;
                font-size: 18px;
                padding: 0 10px;
            }
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                padding: 0 10px;
            }
            
            .product-card {
                margin-bottom: 15px;
            }
            
            .product-card img {
                height: 150px;
            }
            
            .product-card-content {
                padding: 12px;
            }
            
            .product-card h3 {
                font-size: 16px;
                margin: 8px 0;
            }
            
            .product-card .price {
                font-size: 18px;
                margin: 4px 0;
            }
            
            .product-card .rating {
                font-size: 12px;
            }
            
            .product-card p {
                font-size: 13px;
                line-height: 1.4;
            }
            
            .product-card .actions {
                margin-top: 12px;
            }
            
            .product-card .actions button {
                padding: 8px 12px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: 1fr;
                gap: 12px;
                padding: 0 8px;
            }
            
            .product-card img {
                height: 180px;
            }
            
            .product-card-content {
                padding: 15px;
            }
            
            .product-card h3 {
                font-size: 18px;
            }
            
            .product-card .price {
                font-size: 20px;
            }
            
            .product-card .actions button {
                padding: 10px 16px;
                font-size: 16px;
                width: 100%;
            }
        }

        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Dark mode styles for product cards */
        .dark .product-card {
            background: #2d3748;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .product-card-content {
            padding: 15px;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for product card content */
        .dark .product-card-content {
            color: #e2e8f0;
        }

        .product-card h3 {
            margin: 10px 0;
            transition: color 0.3s ease;
        }

        /* Dark mode styles for product card headings */
        .dark .product-card h3 {
            color: #e2e8f0;
        }

        .product-card .price {
            font-size: 20px;
            margin: 5px 0;
        }

        .product-card .rating {
            font-size: 14px;
        }

        .product-card         .actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .product-card .actions button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-secondary {
            background-color: #f0f0f0;
            color: #333;
        }

        /* Footer */
        footer {
            background-color: #343a40;
            color: white;
            padding: 40px 0 20px;
            margin-top: 50px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .footer-column h3 {
            margin-bottom: 20px;
            font-size: 18px;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column ul li {
            margin-bottom: 10px;
        }

        .footer-column ul li a:hover {
            color: #007bff;
        }

        .contact-info p {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid #495057;
            font-size: 14px;
            color: #adb5bd;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 16px;
            border-radius: 10px;
            width: 90%;
            max-width: 420px;
            max-height: 80vh;
            position: relative;
            transition: background-color 0.3s ease;
        }

        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            .modal-content {
                padding: 12px;
                max-height: 90vh;
                width: 95%;
                max-width: 100%;
                overflow-y: auto;
            }
            
            .modal {
                padding: 0.5rem;
            }
            
            .modal-content h2 {
                font-size: 1.1rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            .modal-content h3 {
                font-size: 0.875rem !important;
                padding-bottom: 0.25rem !important;
            }
            
            .modal-content input,
            .modal-content select {
                padding: 0.5rem 0.75rem !important;
                font-size: 0.875rem !important;
            }
            
            .modal-content label {
                font-size: 0.75rem !important;
                margin-bottom: 0.25rem !important;
            }
            
            .modal-content p {
                font-size: 0.75rem !important;
                margin-top: 0.25rem !important;
            }
            
            .modal-content .space-y-3 > * + * {
                margin-top: 0.5rem !important;
            }
            
            .modal-content .space-y-2 > * + * {
                margin-top: 0.375rem !important;
            }
            
            .modal-content .gap-2 {
                gap: 0.375rem !important;
            }
            
            .modal-content button {
                padding: 0.5rem 1rem !important;
                font-size: 0.875rem !important;
            }
            
            .mobile-header {
                padding: 0.75rem 1rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            .mobile-title {
                font-size: 0.875rem !important;
            }
            
            .mobile-subtitle {
                font-size: 0.75rem !important;
            }
            
            .mobile-form {
                margin-top: 0 !important;
            }
            
            .mobile-section {
                margin-bottom: 0.5rem !important;
            }
            
            .mobile-section h3 {
                margin-bottom: 0.5rem !important;
            }
            
            .mobile-grid {
                gap: 0.5rem !important;
            }
            
            @media (max-width: 480px) {
                .mobile-grid {
                    grid-template-columns: 1fr !important;
                    gap: 0.375rem !important;
                }
                
                .modal-content {
                    padding: 8px;
                    max-height: 95vh;
                }
                
                .modal-content h2 {
                    font-size: 1rem !important;
                    margin-bottom: 0.5rem !important;
                }
                
                .modal-content input,
                .modal-content select {
                    padding: 0.375rem 0.5rem !important;
                    font-size: 0.8rem !important;
                }
                
                .modal-content label {
                    font-size: 0.7rem !important;
                }
                
                .modal-content p {
                    font-size: 0.7rem !important;
                }
            }
        }

        /* Dark mode styles for modal content */
        .dark .modal-content {
            background-color: #2d3748;
            color: #e2e8f0;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
        }

        /* Dark mode styles for form inputs */
        .dark .form-group input,
        .dark .form-group select {
            background-color: #4a5568;
            border-color: #718096;
            color: #e2e8f0;
        }

        .dark .form-group input:focus,
        .dark .form-group select:focus {
            border-color: #60a5fa;
            outline: none;
        }

        /* Enhanced dark mode styles for the order form */
        .dark .modal-content {
            background-color: #1e293b;
            color: #e2e8f0;
        }

        .dark .modal-content h2,
        .dark .modal-content h3 {
            color: #f1f5f9;
        }

        .dark .modal-content label {
            color: #cbd5e1;
        }

        .dark .modal-content input,
        .dark .modal-content select,
        .dark .modal-content textarea {
            background-color: #334155;
            border-color: #475569;
            color: #e2e8f0;
        }

        .dark .modal-content input:focus,
        .dark .modal-content select:focus,
        .dark .modal-content textarea:focus {
            border-color: #60a5fa;
            background-color: #374151;
        }

        .dark .modal-content input::placeholder,
        .dark .modal-content textarea::placeholder {
            color: #9ca3af;
        }

        .dark .modal-content select option {
            background-color: #334155;
            color: #e2e8f0;
        }

        .dark .modal-content .bg-gray-50 {
            background-color: #374151;
        }

        .dark .modal-content .border-gray-200 {
            border-color: #475569;
        }

        .dark .modal-content .text-gray-700 {
            color: #cbd5e1;
        }

        .dark .modal-content .text-gray-900 {
            color: #f1f5f9;
        }

        .dark .modal-content .text-gray-600 {
            color: #94a3b8;
        }

        .dark .modal-content .text-gray-500 {
            color: #6b7280;
        }

        .dark .modal-content .bg-gray-100 {
            background-color: #475569;
        }

        .dark .modal-content .border-b {
            border-bottom-color: #475569;
        }

        .submit-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
        }

        .submit-button:hover {
            background-color: #218838;
        }

        .success-message {
            display: none;
            text-align: center;
            color: #28a745;
            font-weight: bold;
            margin-top: 20px;
        }
        
        /* Enhanced modal styles */
        .modal-content {
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Form input focus styles */
        .form-input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        
        /* Error state styles */
        .border-red-500 {
            border-color: #ef4444 !important;
        }
        
        .ring-red-200 {
            box-shadow: 0 0 0 3px rgba(254, 202, 202, 0.5) !important;
        }
        
        /* Loading spinner */
        .fa-spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .loading-spinner {
            @apply inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-primary-600;
        }
        
        .loading-feature {
            @apply text-slate-500 dark:text-slate-400 italic;
        }
            
        /* Mobile Slider Styles */
        .mobile-slider {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .slider-container {
            position: relative;
            width: 100%;
            height: 300px;
        }

        .slider-track {
            display: flex;
            transition: transform 0.3s ease-in-out;
            height: 100%;
        }

        .slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 10px;
        }

        .slider-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .slider-nav:hover {
            background: rgba(255, 255, 255, 1);
            transform: translateY(-50%) scale(1.1);
        }

        .slider-prev {
            left: 10px;
        }

        .slider-next {
            right: 10px;
        }

        .slider-nav i {
            color: #333;
            font-size: 16px;
        }

        .slider-dots {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dot.active {
            background: #007bff;
            transform: scale(1.2);
        }

        .dot:hover {
            background: rgba(255, 255, 255, 0.8);
        }

        /* Dark mode support for mobile slider */
        .dark .slider-nav {
            background: rgba(45, 55, 72, 0.9);
        }

        .dark .slider-nav:hover {
            background: rgba(45, 55, 72, 1);
        }

        .dark .slider-nav i {
            color: #e2e8f0;
        }

        .dark .dot {
            background: rgba(45, 55, 72, 0.6);
        }

        .dark .dot:hover {
            background: rgba(45, 55, 72, 0.8);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .product-container {
                flex-direction: column;
            }
            
            .cta-section {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .tab-buttons {
                flex-direction: column;
            }

            .slider-container {
                height: 250px;
            }

            .slider-nav {
                width: 35px;
                height: 35px;
            }

            .slider-nav i {
                font-size: 14px;
            }

            .dot {
                width: 6px;
                height: 6px;
            }
        }

        @media (max-width: 480px) {
            .slider-container {
                height: 200px;
            }

            .slider-nav {
                width: 30px;
                height: 30px;
            }

            .slider-nav i {
                font-size: 12px;
            }

            .slider-dots {
                bottom: 10px;
                gap: 6px;
            }

            .dot {
                width: 5px;
                height: 5px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 dark:bg-slate-900 dark:text-gray-200 transition-colors duration-300 font-sans overflow-x-hidden">
    <!-- Simple Header with Logo -->
    <header class="sticky top-0 z-40 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center">
                    <a href="index.html" class="flex items-center space-x-2">
                        <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 flex items-center justify-center shadow-lg">
                            <span class="text-white font-bold text-xl">DH</span>
                        </div>
                        <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">Phone</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container min-h-screen overflow-y-auto">
        <!-- Product Section -->
        <section class="product-container">
            <div class="product-images">
                <!-- Desktop version (hidden on mobile) -->
                <div class="desktop-images hidden md:block">
                    <img src="https://placehold.co/600x600" alt="Premium Smartphone X1" class="main-image">
                    <div class="thumbnail-images">
                        <img src="https://placehold.co/100x100" alt="View 1" class="thumbnail active">
                        <img src="https://placehold.co/100x100" alt="View 2" class="thumbnail">
                        <img src="https://placehold.co/100x100" alt="View 3" class="thumbnail">
                        <img src="https://placehold.co/100x100" alt="View 4" class="thumbnail">
                    </div>
                </div>
                
                <!-- Mobile slider (visible only on mobile) -->
                <div class="mobile-slider md:hidden">
                    <div class="slider-container">
                        <div class="slider-track">
                            <div class="slide active">
                                <img src="https://placehold.co/600x600" alt="Premium Smartphone X1 - View 1" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                            </div>
                            <div class="slide">
                                <img src="https://placehold.co/600x600" alt="Premium Smartphone X1 - View 2" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                            </div>
                            <div class="slide">
                                <img src="https://placehold.co/600x600" alt="Premium Smartphone X1 - View 3" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                            </div>
                            <div class="slide">
                                <img src="https://placehold.co/600x600" alt="Premium Smartphone X1 - View 4" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                            </div>
                        </div>
                        
                        <!-- Navigation arrows -->
                        <button class="slider-nav slider-prev" aria-label="Previous image">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="slider-nav slider-next" aria-label="Next image">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        
                        <!-- Dots indicator -->
                        <div class="slider-dots">
                            <span class="dot active" data-slide="0"></span>
                            <span class="dot" data-slide="1"></span>
                            <span class="dot" data-slide="2"></span>
                            <span class="dot" data-slide="3"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="product-info">
                <h1 class="product-title">Premium Smartphone X1</h1>
                <div class="price">$899.99 <span class="original-price">$1,199.99</span></div>
                <div class="rating">
                    ★★★★★ 4.7 (128 Reviews)
    </div>
                <div class="stock-status">Contact for Availability</div>
                <div id="shopify-status" class="text-sm text-gray-500 mt-2" style="display: none;">
                    <span id="status-icon">🔍</span>
                    <span id="status-text">Testing Shopify connection...</span>
                </div>
                <div id="algeria-status" class="text-sm text-gray-500 mt-2" style="display: none;">
                    <span id="algeria-icon">🇩🇿</span>
                    <span id="algeria-text">Loading Algeria data...</span>
                    <button id="load-all-wilayas" class="ml-2 px-2 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600" onclick="loadAllWilayas()" style="display: none;">
                        Load All 58 Wilayas
                    </button>
                </div>
                
                <h3>Key Features</h3>
                <ul id="dynamic-features" class="features-list">
                    <li class="loading-feature">Loading features...</li>
                </ul>
                
                <div class="cta-section">
                    <button class="order-now-button" onclick="openModal()">Order Now</button>
                    <button id="load-algeria-btn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm" onclick="loadWilayaData()" style="display: inline-block;">
                        🇩🇿 Load Algeria Data
                    </button>
                    <div class="share-options">
                        <span class="share-label">Share:</span>
                        <div class="share-icons">
                            <a href="#" class="share-btn facebook" title="Share on Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="share-btn tiktok" title="Share on TikTok">
                                <i class="fab fa-tiktok"></i>
                            </a>
                            <a href="#" class="share-btn instagram" title="Share on Instagram">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="share-btn whatsapp" title="Share on WhatsApp">
                                <i class="fab fa-whatsapp"></i>
                            </a>
    </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Tabs Section -->
        <section class="tabs">
            <div class="tab-buttons">
                <button class="tab-button active" onclick="openTab(event, 'details')">Product Details</button>
                <button class="tab-button" onclick="openTab(event, 'specs')">Specifications</button>
        </div>

            <div id="details" class="tab-content">
                <h2>About this item</h2>
                <p>Experience cutting-edge technology with our latest Premium Smartphone X1 that combines elegant design with powerful performance. This device features a premium build quality with an immersive display, advanced camera system for stunning photos, and all-day battery life to keep you connected.</p>
                <p>The smartphone boasts a sleek design with premium materials, making it not just a powerful device but also a style statement. Whether you're capturing memories, streaming content, or staying productive on the go, this phone delivers exceptional performance in every scenario.</p>
            </div>
            
            <div id="specs" class="tab-content" style="display:none">
                <h2>Technical Specifications</h2>
                <table id="dynamic-specs" class="specifications-table">
                    <tr>
                        <td colspan="2" class="text-center py-8">
                            <div class="loading-spinner inline-block"></div>
                            <p class="mt-2 text-slate-500 dark:text-slate-400">Loading specifications...</p>
                        </td>
                    </tr>
                </table>
            </div>
        </section>
        
        <!-- Related Products -->
        <section class="related-products">
            <h2 class="section-title">You May Also Like</h2>
            <div id="related-products-grid" class="products-grid">
                <div class="col-span-full text-center py-8">
                    <div class="loading-spinner inline-block"></div>
                    <p class="mt-2 text-slate-500 dark:text-slate-400">Loading related products...</p>
                </div>
            </div>
        </section>
        </div>

    <!-- Scroll to top button -->
    <div id="scroll-to-top" class="scroll-indicator" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white mt-8 md:mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 md:gap-8">
                <!-- Company Info -->
                <div class="col-span-1 md:col-span-2">
                    <h3 class="text-lg md:text-xl font-bold mb-3 md:mb-4">🛍️ DH Phone</h3>
                    <p class="text-sm md:text-base text-gray-300 mb-3 md:mb-4">Your trusted partner for all your phone needs. Quality products, excellent service, and unbeatable prices.</p>
                    <div class="flex space-x-3 md:space-x-4">
                        <!-- Facebook Icon -->
                        <a href="https://www.facebook.com/profile.php?id=100058599200790" target="_blank" rel="noopener" class="text-gray-400 hover:text-white transition-colors duration-300" aria-label="Facebook">
                            <i class="fab fa-facebook-f fa-lg"></i>
                        </a>
                        <!-- Instagram Icon -->
                        <a href="coming-soon.html" class="text-gray-400 hover:text-white transition-colors duration-300" aria-label="Instagram">
                            <i class="fab fa-instagram fa-lg"></i>
                        </a>
                        <!-- WhatsApp Icon -->
                        <a href="https://api.whatsapp.com/message/UDDWXQWO7GXJC1?autoload=1&app_absent=0" target="_blank" rel="noopener" class="text-gray-400 hover:text-white transition-colors duration-300" aria-label="WhatsApp">
                            <i class="fab fa-whatsapp fa-lg"></i>
                        </a>
                        <!-- TikTok Icon -->
                        <a href="https://www.tiktok.com/@dh.phone2?_t=ZM-8yC4GUv4nyy&_r=1" target="_blank" rel="noopener" class="text-gray-400 hover:text-white transition-colors duration-300" aria-label="TikTok">
                            <svg class="w-5 h-5 md:w-6 md:h-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-.88-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                <!-- Quick Links -->
                <div>
                    <h4 class="text-base md:text-lg font-semibold mb-3 md:mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-sm md:text-base text-gray-300 hover:text-white transition-colors duration-300">Home</a></li>
                        <li><a href="porduct.html" class="text-sm md:text-base text-gray-300 hover:text-white transition-colors duration-300">Products</a></li>
                        <li><a href="Contact.html" class="text-sm md:text-base text-gray-300 hover:text-white transition-colors duration-300">Contact</a></li>
                    </ul>
                </div>
                <!-- Contact Info -->
                <div>
                    <h4 class="text-base md:text-lg font-semibold mb-3 md:mb-4">Contact Info</h4>
                    <div class="space-y-2 text-sm md:text-base text-gray-300">
                        <p>📞 0559364881</p>
                        <p>📍 <a href="https://www.google.com/maps/place/DH+phone/@35.531125,-0.190004,144m/data=!3m1!1e3!4m6!3m5!1s0xd7e3d9d8913e5e9:0x463fa5ab4ea63ab3!8m2!3d35.5311248!4d-0.1900038!16s%2Fg%2F11tnyjcw86?hl=en&entry=ttu&g_ep=EgoyMDI1MDcyMy4wIKXMDSoASAFQAw%3D%3D" target="_blank" rel="noopener">Our Location</a></p>
                    </div>
                </div>
            </div>
            <!-- Bottom Bar -->
            <div class="border-t border-gray-800 mt-6 md:mt-8 pt-6 md:pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-xs md:text-sm text-gray-400 text-center md:text-left">
                        © 2024 DH Phone. All rights reserved.
                    </p>
                    <div class="flex items-center space-x-2 mt-3 md:mt-0">
                        <span class="text-xs md:text-sm text-gray-400">Made with</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 text-red-500" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <span class="text-xs md:text-sm text-gray-400">by <a href="https://www.instagram.com/tayabe_doom_?igsh=c29raG8xMXA1cHV5" target="_blank" rel="noopener" class="text-blue-400 hover:text-blue-300 transition-colors duration-300">tayabedoom</a></span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Order Modal -->
    <div id="orderModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Complete your purchase</h2>
            
            <!-- Form Header -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-700 px-2.5 py-1.5 rounded-lg mb-3 mobile-header">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-sm font-bold text-white mobile-title">Order Form</h3>
                        <p class="text-blue-100 text-xs mobile-subtitle">Complete your purchase information</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <div class="bg-white bg-opacity-20 p-1 rounded-full">
                            <i class="fas fa-shopping-cart text-white text-xs"></i>
                        </div>
                    </div>
                </div>
            </div>

                                    <form id="orderForm" class="space-y-3 mobile-form">
                <!-- Personal Information Section -->
                <div class="space-y-2 mobile-section">
                    <h3 class="text-sm font-semibold text-gray-800 border-b border-gray-200 pb-1 flex items-center">
                        <i class="fas fa-user-circle mr-2 text-blue-600 text-xs"></i> Personal Information
                    </h3>
                    
                    <!-- Full Name -->
                    <div>
                        <label for="fullName" class="block text-xs font-medium text-gray-700 mb-0.5">
                            <span data-en="Full Name" data-fr="Nom Complet" data-ar="الاسم الكامل">Full Name</span> <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <input type="text" id="fullName" name="fullName" required
                                class="w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm"
                                placeholder="Ahmed Benzine">
                            <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                <i class="fas fa-user text-gray-400 text-xs"></i>
                            </div>
                        </div>
                        <p class="mt-0.5 text-xs text-gray-500">
                            <span data-en="Enter your full name as it appears on your ID" data-fr="Entrez votre nom complet tel qu'il apparaît sur votre carte d'identité" data-ar="أدخل اسمك الكامل كما يظهر في بطاقة الهوية">Enter your full name as it appears on your ID</span>
                        </p>
                        <p class="mt-0.5 text-xs text-red-600 hidden" id="fullNameError">
                            <span data-en="Please enter your full name" data-fr="Veuillez entrer votre nom complet" data-ar="يرجى إدخال اسمك الكامل">Please enter your full name</span>
                        </p>
                    </div>
                    
                    <!-- Email and Phone -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mobile-grid">
                        <!-- Email -->
                        <div>
                            <label for="email" class="block text-xs font-medium text-gray-700 mb-0.5">
                                <span data-en="Email Address" data-fr="Adresse Email" data-ar="عنوان البريد الإلكتروني">Email Address</span> <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input type="email" id="email" name="email" required
                                    class="w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm"
                                    placeholder="ahmed.benzine@gmail.com">
                                <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                    <i class="fas fa-envelope text-gray-400 text-xs"></i>
                                </div>
                            </div>
                            <p class="mt-0.5 text-xs text-gray-500">
                                <span data-en="We'll send order confirmation to this email" data-fr="Nous enverrons la confirmation de commande à cet email" data-ar="سنرسل تأكيد الطلب إلى هذا البريد الإلكتروني">We'll send order confirmation to this email</span>
                            </p>
                            <p class="mt-0.5 text-xs text-red-600 hidden" id="emailError">
                                <span data-en="Please enter a valid email address" data-fr="Veuillez entrer une adresse email valide" data-ar="يرجى إدخال عنوان بريد إلكتروني صحيح">Please enter a valid email address</span>
                            </p>
                        </div>
                        
                        <!-- Phone -->
                        <div>
                            <label for="phone" class="block text-xs font-medium text-gray-700 mb-0.5">
                                <span data-en="Phone Number" data-fr="Numéro de Téléphone" data-ar="رقم الهاتف">Phone Number</span> <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input type="tel" id="phone" name="phone" required
                                    class="w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm"
                                    placeholder="05 61 23 45 67">
                                <div class="absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none">
                                    <i class="fas fa-phone text-gray-400 text-xs"></i>
                                </div>
                            </div>
                            <p class="mt-0.5 text-xs text-gray-500">
                                <span data-en="Format: 05 XX XX XX XX (Mobile) or 02 XX XX XX XX (Landline)" data-fr="Format: 05 XX XX XX XX (Mobile) ou 02 XX XX XX XX (Fixe)" data-ar="التنسيق: 05 XX XX XX XX (جوال) أو 02 XX XX XX XX (ثابت)">Format: 05 XX XX XX XX (Mobile) or 02 XX XX XX XX (Landline)</span>
                            </p>
                            <p class="mt-0.5 text-xs text-red-600 hidden" id="phoneError">
                                <span data-en="Please enter a valid Algerian phone number" data-fr="Veuillez entrer un numéro de téléphone algérien valide" data-ar="يرجى إدخال رقم هاتف جزائري صحيح">Please enter a valid Algerian phone number</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Address Information Section -->
                <div class="space-y-2 mobile-section">
                    <h3 class="text-sm font-semibold text-gray-800 border-b border-gray-200 pb-1 flex items-center">
                        <i class="fas fa-map-marker-alt mr-2 text-blue-600 text-xs"></i> 
                        <span data-en="Address Information" data-fr="Informations d'Adresse" data-ar="معلومات العنوان">Address Information</span>
                    </h3>
                    
                    <!-- Wilaya and Daira -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mobile-grid">
                        <!-- Wilaya -->
                        <div>
                            <label for="wilaya" class="block text-xs font-medium text-gray-700 mb-0.5">
                                <span data-en="Wilaya" data-fr="Wilaya" data-ar="الولاية">Wilaya</span> <span class="text-red-500">*</span>
                            </label>
                            <select id="wilaya" name="wilaya" required
                                class="w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 text-sm">
                                <option value="" disabled selected>
                                    <span data-en="Select your wilaya" data-fr="Sélectionnez votre wilaya" data-ar="اختر ولايتك">Select your wilaya</span>
                                </option>
                                <!-- Wilaya options will be populated by JavaScript -->
                            </select>
                            <p class="mt-0.5 text-xs text-red-600 hidden" id="wilayaError">
                                <span data-en="Please select your wilaya" data-fr="Veuillez sélectionner votre wilaya" data-ar="يرجى اختيار ولايتك">Please select your wilaya</span>
                            </p>
                        </div>
                        
                        <!-- Daira -->
                        <div>
                            <label for="daira" class="block text-xs font-medium text-gray-700 mb-0.5">
                                <span data-en="Daïra" data-fr="Daïra" data-ar="الدائرة">Daïra</span> <span class="text-red-500">*</span>
                            </label>
                            <select id="daira" name="daira" required disabled
                                class="w-full px-2.5 py-1.5 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-100 transition-all duration-200 text-sm">
                                <option value="" disabled selected>
                                    <span data-en="Select your daïra" data-fr="Sélectionnez votre daïra" data-ar="اختر دائرة">Select your daïra</span>
                                </option>
                            </select>
                            <p class="mt-0.5 text-xs text-red-600 hidden" id="dairaError">
                                <span data-en="Please select your daïra" data-fr="Veuillez sélectionner votre daïra" data-ar="يرجى اختيار دائرة">Please select your daïra</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="pt-1">
                    <button type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:scale-[1.01] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 text-sm">
                        <i class="fas fa-paper-plane mr-2"></i> 
                        <span data-en="Submit Order" data-fr="Soumettre la Commande" data-ar="إرسال الطلب">Submit Order</span>
                    </button>
                </div>
            </form>

            <!-- Success Message (hidden by default) -->
            <div id="successMessage" class="hidden p-6 bg-green-50 border-l-4 border-green-500 rounded-lg">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <i class="fas fa-check-circle text-green-500 text-2xl"></i>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-green-800">Order submitted successfully!</h3>
                        <p class="mt-1 text-sm text-green-700">We've received your order and will contact you shortly. Thank you!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
                // Function to load all 58 Wilayas
        function loadAllWilayas() {
            const algeriaStatusDiv = document.getElementById('algeria-status');
            const algeriaIcon = document.getElementById('algeria-icon');
            const algeriaText = document.getElementById('algeria-text');
            const loadButton = document.getElementById('load-all-wilayas');
            
            if (algeriaStatusDiv) {
                algeriaIcon.textContent = '🇩🇿';
                algeriaText.textContent = 'Loading all 58 Wilayas...';
                if (loadButton) {
                    loadButton.style.display = 'none';
                }
            }
            
            // Use the complete list of all 58 Algerian Wilayas
            algeriaData = allAlgeriaWilayas.map(wilaya => ({
                wilaya_name: wilaya.wilaya_name,
                wilaya_name_ar: wilaya.wilaya_name_ar,
                daira_names: [],
                daira_names_ar: []
            }));
            
            populateWilayas();
            
            if (algeriaStatusDiv) {
                algeriaIcon.textContent = '✅';
                algeriaText.textContent = `Loaded all 58 Wilayas successfully!`;
            }
            
            console.log('✅ Loaded all 58 Algerian Wilayas');
        }
        
        // Algerian provinces and districts data
        let algeriaData = [];
        
        // Complete list of all 58 Algerian Wilayas
        const allAlgeriaWilayas = [
            { "wilaya_name": "Adrar", "wilaya_name_ar": "أدرار" },
            { "wilaya_name": "Aïn Defla", "wilaya_name_ar": "عين الدفلة" },
            { "wilaya_name": "Aïn Témouchent", "wilaya_name_ar": "عين تيموشنت" },
            { "wilaya_name": "Alger", "wilaya_name_ar": "الجزائر" },
            { "wilaya_name": "Annaba", "wilaya_name_ar": "عنابة" },
            { "wilaya_name": "Batna", "wilaya_name_ar": "باتنة" },
            { "wilaya_name": "Béchar", "wilaya_name_ar": "بشار" },
            { "wilaya_name": "Béjaïa", "wilaya_name_ar": "بجاية" },
            { "wilaya_name": "Béni Abbès", "wilaya_name_ar": "بني عباس" },
            { "wilaya_name": "Biskra", "wilaya_name_ar": "بسكرة" },
            { "wilaya_name": "Blida", "wilaya_name_ar": "البليدة" },
            { "wilaya_name": "Bordj Badji Mokhtar", "wilaya_name_ar": "برج باجي مختار" },
            { "wilaya_name": "Bordj Bou Arreridj", "wilaya_name_ar": "برج بوعريريج" },
            { "wilaya_name": "Bouira", "wilaya_name_ar": "البويرة" },
            { "wilaya_name": "Boumerdès", "wilaya_name_ar": "بومرداس" },
            { "wilaya_name": "Chlef", "wilaya_name_ar": "الشلف" },
            { "wilaya_name": "Constantine", "wilaya_name_ar": "قسنطينة" },
            { "wilaya_name": "Djanet", "wilaya_name_ar": "جانت" },
            { "wilaya_name": "Djelfa", "wilaya_name_ar": "الجلفة" },
            { "wilaya_name": "El Bayadh", "wilaya_name_ar": "البيض" },
            { "wilaya_name": "El Meghaier", "wilaya_name_ar": "المغير" },
            { "wilaya_name": "El Menia", "wilaya_name_ar": "المنيعة" },
            { "wilaya_name": "El Oued", "wilaya_name_ar": "الوادي" },
            { "wilaya_name": "El Tarf", "wilaya_name_ar": "الطارف" },
            { "wilaya_name": "Ghardaïa", "wilaya_name_ar": "غرداية" },
            { "wilaya_name": "Guelma", "wilaya_name_ar": "قالمة" },
            { "wilaya_name": "Illizi", "wilaya_name_ar": "إليزي" },
            { "wilaya_name": "In Guezzam", "wilaya_name_ar": "عين قزام" },
            { "wilaya_name": "In Salah", "wilaya_name_ar": "عين صالح" },
            { "wilaya_name": "Jijel", "wilaya_name_ar": "جيجل" },
            { "wilaya_name": "Khenchela", "wilaya_name_ar": "خنشلة" },
            { "wilaya_name": "Laghouat", "wilaya_name_ar": "الأغواط" },
            { "wilaya_name": "M'Sila", "wilaya_name_ar": "المسيلة" },
            { "wilaya_name": "Mascara", "wilaya_name_ar": "معسكر" },
            { "wilaya_name": "Médéa", "wilaya_name_ar": "المدية" },
            { "wilaya_name": "Mila", "wilaya_name_ar": "ميلة" },
            { "wilaya_name": "Mostaganem", "wilaya_name_ar": "مستغانم" },
            { "wilaya_name": "Naâma", "wilaya_name_ar": "النعامة" },
            { "wilaya_name": "Oran", "wilaya_name_ar": "وهران" },
            { "wilaya_name": "Ouargla", "wilaya_name_ar": "ورقلة" },
            { "wilaya_name": "Ouled Djellal", "wilaya_name_ar": "أولاد جلال" },
            { "wilaya_name": "Oum El Bouaghi", "wilaya_name_ar": "أم البواقي" },
            { "wilaya_name": "Relizane", "wilaya_name_ar": "غليزان" },
            { "wilaya_name": "Saïda", "wilaya_name_ar": "سعيدة" },
            { "wilaya_name": "Sétif", "wilaya_name_ar": "سطيف" },
            { "wilaya_name": "Sidi Bel Abbès", "wilaya_name_ar": "سيدي بلعباس" },
            { "wilaya_name": "Skikda", "wilaya_name_ar": "سكيكدة" },
            { "wilaya_name": "Souk Ahras", "wilaya_name_ar": "سوق أهراس" },
            { "wilaya_name": "Tamanrasset", "wilaya_name_ar": "تمنراست" },
            { "wilaya_name": "Tébessa", "wilaya_name_ar": "تبسة" },
            { "wilaya_name": "Tiaret", "wilaya_name_ar": "تيارت" },
            { "wilaya_name": "Timimoun", "wilaya_name_ar": "تيميمون" },
            { "wilaya_name": "Tindouf", "wilaya_name_ar": "تندوف" },
            { "wilaya_name": "Tipaza", "wilaya_name_ar": "تيبازة" },
            { "wilaya_name": "Tissemsilt", "wilaya_name_ar": "تيسمسيلت" },
            { "wilaya_name": "Tizi Ouzou", "wilaya_name_ar": "تيزي وزو" },
            { "wilaya_name": "Tlemcen", "wilaya_name_ar": "تلمسان" },
            { "wilaya_name": "Touggourt", "wilaya_name_ar": "تقرت" }
        ];

        // Function to load Wilaya data from the algeria-cities repository
        async function loadWilayaData() {
            const algeriaStatusDiv = document.getElementById('algeria-status');
            const algeriaIcon = document.getElementById('algeria-icon');
            const algeriaText = document.getElementById('algeria-text');
            
            if (algeriaStatusDiv) {
                algeriaStatusDiv.style.display = 'block';
                algeriaIcon.textContent = '🇩🇿';
                algeriaText.textContent = 'Loading Algeria data...';
            }
            
            try {
                // Try different URLs for the algeria-cities repository
                let response;
                try {
                    response = await fetch('https://raw.githubusercontent.com/othmanus/algeria-cities/master/json/algeria-cities.json');
                } catch (e) {
                    response = await fetch('https://raw.githubusercontent.com/othmanus/algeria-cities/master/json/ascii/algeria-cities.json');
                }
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Transform the data to match our expected format
                algeriaData = data.map(wilaya => {
                    // Handle different possible data structures
                    let daira_names = [];
                    let daira_names_ar = [];
                    
                    if (wilaya.dairas && Array.isArray(wilaya.dairas)) {
                        daira_names = wilaya.dairas.map(daira => daira.daira_name || daira.name || '');
                        daira_names_ar = wilaya.dairas.map(daira => daira.daira_name_ar || daira.name_ar || '');
                    } else if (wilaya.daira_names && Array.isArray(wilaya.daira_names)) {
                        daira_names = wilaya.daira_names;
                        daira_names_ar = wilaya.daira_names_ar || [];
                    }
                    
                    return {
                        wilaya_name: wilaya.wilaya_name || wilaya.name || '',
                        wilaya_name_ar: wilaya.wilaya_name_ar || wilaya.name_ar || '',
                        daira_names: daira_names,
                        daira_names_ar: daira_names_ar
                    };
                });
                
                populateWilayas();
                
                // Show success status
                if (algeriaStatusDiv) {
                    algeriaIcon.textContent = '✅';
                    algeriaText.textContent = `Loaded ${algeriaData.length} wilayas from GitHub`;
                }
                
            } catch (error) {
                // Show error status and provide option to load all Wilayas
                if (algeriaStatusDiv) {
                    algeriaIcon.textContent = '❌';
                    algeriaText.textContent = `API Error: ${error.message}`;
                    
                    // Show the button to load all Wilayas
                    const loadButton = document.getElementById('load-all-wilayas');
                    if (loadButton) {
                        loadButton.style.display = 'inline-block';
                    }
                }
                
                // Use basic fallback with just Wilaya names
                algeriaData = allAlgeriaWilayas.map(wilaya => ({
                    wilaya_name: wilaya.wilaya_name,
                    wilaya_name_ar: wilaya.wilaya_name_ar,
                    daira_names: [],
                    daira_names_ar: []
                }));
                populateWilayas();
            }
        }

        // Populate Wilaya dropdown
        function populateWilayas() {
            const wilayaSelect = document.getElementById('wilaya');
            if (!wilayaSelect) return;
            
            // Get current language
            const currentLang = document.documentElement.lang || 'en';
            
            // Get appropriate placeholder text
            let placeholderText = 'Select your wilaya';
            if (currentLang === 'fr') placeholderText = 'Sélectionnez votre wilaya';
            if (currentLang === 'ar') placeholderText = 'اختر ولايتك';
            
            // Clear existing options
            wilayaSelect.innerHTML = `<option value="" disabled selected>${placeholderText}</option>`;
            
            algeriaData.forEach(wilaya => {
                const option = document.createElement('option');
                option.value = wilaya.wilaya_name;
                
                // Use Arabic name if available and language is Arabic
                if (currentLang === 'ar' && wilaya.wilaya_name_ar) {
                    option.textContent = wilaya.wilaya_name_ar;
                } else {
                    option.textContent = wilaya.wilaya_name;
                }
                
                wilayaSelect.appendChild(option);
            });
        }

        // Update Daira dropdown based on selected Wilaya
        function updateDairas() {
            const wilayaSelect = document.getElementById('wilaya');
            const dairaSelect = document.getElementById('daira');
            
            if (!wilayaSelect || !dairaSelect) return;
            
            // Get current language
            const currentLang = document.documentElement.lang || 'en';
            
            // Get appropriate placeholder text
            let placeholderText = 'Select your daïra';
            if (currentLang === 'fr') placeholderText = 'Sélectionnez votre daïra';
            if (currentLang === 'ar') placeholderText = 'اختر دائرة';
            
            const selectedWilaya = wilayaSelect.value;
            const wilaya = algeriaData.find(w => w.wilaya_name === selectedWilaya);
            
            // Clear previous options
            dairaSelect.innerHTML = `<option value="" disabled selected>${placeholderText}</option>`;
            
            if (wilaya) {
                // Enable daira select
                dairaSelect.disabled = false;
                dairaSelect.classList.remove('bg-gray-100');
                
                // Add new options
                wilaya.daira_names.forEach(daira => {
                    const option = document.createElement('option');
                    option.value = daira;
                    
                    // Use Arabic name if available and language is Arabic
                    if (currentLang === 'ar' && wilaya.daira_names_ar) {
                        const dairaIndex = wilaya.daira_names.indexOf(daira);
                        if (dairaIndex !== -1 && wilaya.daira_names_ar[dairaIndex]) {
                            option.textContent = wilaya.daira_names_ar[dairaIndex];
                        } else {
                            option.textContent = daira;
                        }
                    } else {
                        option.textContent = daira;
                    }
                    
                    dairaSelect.appendChild(option);
                });
            } else {
                // Disable daira select if no wilaya selected
                dairaSelect.disabled = true;
                dairaSelect.classList.add('bg-gray-100');
            }
        }

        // Form validation
        function validateForm() {
            let isValid = true;
            
            // Reset error states
            document.querySelectorAll('[id$="Error"]').forEach(el => {
                el.classList.add('hidden');
                const input = el.previousElementSibling;
                if (input) {
                    input.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
                }
            });
            
            // Validate full name
            const fullName = document.getElementById('fullName');
            if (!fullName.value.trim()) {
                showError('fullName', 'Please enter your full name');
                isValid = false;
            }
            
            // Validate email
            const email = document.getElementById('email');
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email.value.trim()) {
                showError('email', 'Please enter your email address');
                isValid = false;
            } else if (!emailRegex.test(email.value)) {
                showError('email', 'Please enter a valid email address');
                isValid = false;
            }
            
                        // Validate phone (Algerian format: 05, 06, 07 for mobile or 02, 03 for landline)
            const phone = document.getElementById('phone');
            const phoneRegex = /^(0)(2|3|5|6|7)[0-9]{8}$/;
            const phoneValue = phone.value.replace(/\s+/g, '');
            if (!phoneValue) {
                showError('phone', 'Please enter your phone number');
                isValid = false;
            } else if (!phoneRegex.test(phoneValue)) {
                showError('phone', 'Please enter a valid Algerian phone number (05/06/07 for mobile or 02/03 for landline)');
                isValid = false;
            }
            
            // Validate wilaya
            const wilaya = document.getElementById('wilaya');
            if (!wilaya.value) {
                showError('wilaya', 'Please select your wilaya');
                isValid = false;
            }
            
            // Validate daira
            const daira = document.getElementById('daira');
            if (!daira.value) {
                showError('daira', 'Please select your daïra');
                isValid = false;
            }
            
            // Scroll to first error if any
            if (!isValid) {
                const firstError = document.querySelector('.border-red-500');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
            
            return isValid;
        }

        // Helper function to show error messages
        function showError(fieldId, message) {
            const errorElement = document.getElementById(`${fieldId}Error`);
            const inputElement = document.getElementById(fieldId);
            
            if (errorElement && inputElement) {
                errorElement.textContent = message;
                errorElement.classList.remove('hidden');
                inputElement.classList.add('border-red-500', 'ring-2', 'ring-red-200');
                inputElement.focus();
            }
        }

        // Enhanced form submission with EmailJS
        async function submitForm(e) {
            e.preventDefault();
            
            if (!validateForm()) {
                return;
            }

            // Show loading state
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Sending...';

            // Get current product information
            const productTitle = document.querySelector('.product-title')?.textContent || 'Product';
            const productPrice = document.querySelector('.price')?.textContent || 'Contact for price';

            // Prepare form data object
            const formData = {
                full_name: document.getElementById('fullName').value,
                user_email: document.getElementById('email').value,
                phone_number: document.getElementById('phone').value,
                wilaya: document.getElementById('wilaya').value,
                daira: document.getElementById('daira').value,
                product: productTitle,
                product_price: productPrice,
                timestamp: new Date().toLocaleString()
            };

            // Telegram Bot API integration
            const botToken = '7933495075:AAH2tvwxLUsSXtM4UzkSgSq4cb65k6qhSEI';
            // DH-PHONE group chat ID
            const chatId = '-1002894581286';
            const text = `New Order Submission:%0AName: ${formData.full_name}%0AEmail: ${formData.user_email}%0APhone: ${formData.phone_number}%0AWilaya: ${formData.wilaya}%0ADaira: ${formData.daira}%0AProduct: ${formData.product}%0APrice: ${formData.product_price}%0ATime: ${formData.timestamp}`;
            const url = `https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${text}`;

            try {
                const response = await fetch(url, { method: 'GET' });
                if (response.ok) {
                    document.getElementById('orderForm').reset();
                    document.getElementById('successMessage').classList.remove('hidden');
                    document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth' });
                    document.getElementById('orderForm').classList.add('hidden');
                    setTimeout(() => {
                        document.getElementById('successMessage').classList.add('hidden');
                        document.getElementById('orderForm').classList.remove('hidden');
                        closeModal();
                    }, 5000);
                } else {
                    throw new Error('Telegram API returned error');
                }
            } catch (error) {
                console.error('Telegram send failed:', error);
                let errorMessage = 'An error occurred while sending your message. Please try again later.';
                Swal.fire({
                    icon: 'error',
                    title: 'Submission Failed',
                    text: errorMessage,
                    confirmButtonColor: '#3b82f6',
                    footer: 'Error code: ' + (error.status || 'UNKNOWN')
                });
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane mr-2"></i> Submit Order';
            }
        }



        // Tab functionality
        function openTab(evt, tabName) {
            var i, tabcontent, tabbuttons;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Modal functionality
        function openModal() {
            document.getElementById("orderModal").style.display = "flex";
        }

        function closeModal() {
            document.getElementById("orderModal").style.display = "none";
            // Reset form when modal closes
            document.getElementById("orderForm").reset();
            document.getElementById("successMessage").classList.add("hidden");
            document.getElementById("orderForm").classList.remove("hidden");
            // Reset error states
            document.querySelectorAll('[id$="Error"]').forEach(el => {
                el.classList.add('hidden');
            });
            document.querySelectorAll('.border-red-500').forEach(el => {
                el.classList.remove('border-red-500', 'ring-2', 'ring-red-200');
            });
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById("orderModal");
            if (event.target == modal) {
                closeModal();
            }
        };

        // Image gallery functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Shopify first
            initializeShopify();
            
            // Force load Shopify products immediately
            loadShopifyProducts();
            
            // Force load Algeria data immediately
            loadWilayaData();
            
            const mainImage = document.querySelector('.main-image');
            const thumbnails = document.querySelectorAll('.thumbnail');

            thumbnails.forEach(thumbnail => {
                thumbnail.addEventListener('click', function() {
                    mainImage.src = this.src;
                    // Update active state
                    thumbnails.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                });
            });

            // Mobile slider functionality
            const sliderTrack = document.querySelector('.slider-track');
            const slides = document.querySelectorAll('.slide');
            const prevBtn = document.querySelector('.slider-prev');
            const nextBtn = document.querySelector('.slider-next');
            const dots = document.querySelectorAll('.dot');
            let currentIndex = 0;

            function updateSlider() {
                sliderTrack.style.transform = `translateX(-${currentIndex * 100}%)`;
                dots.forEach((dot, index) => {
                    dot.classList.toggle('active', index === currentIndex);
                });
            }

            nextBtn.addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % slides.length;
                updateSlider();
            });

            prevBtn.addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                updateSlider();
            });

            dots.forEach(dot => {
                dot.addEventListener('click', () => {
                    currentIndex = parseInt(dot.dataset.slide);
                    updateSlider();
                });
            });

            // Initialize form
            document.getElementById('orderForm').addEventListener('submit', submitForm);
            document.getElementById('wilaya').addEventListener('change', updateDairas);
            
            // Load Wilaya data
            loadWilayaData();
        });

        // Load product data from Shopify and Firebase
        document.addEventListener('firebaseReady', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const productHandle = urlParams.get('product');

            // Test Shopify connection first
            const connectionTest = await testShopifyConnection();
            
            if (connectionTest) {
                // Load Shopify products automatically
                await loadShopifyProducts();
            } else {
                // Load sample data as fallback
                if (productHandle) {
                    loadSampleProductData(productHandle);
                } else {
                    loadSampleProductData('default-product');
                }
            }
        });

        // Function to load all Shopify products
        async function loadAllShopifyProducts() {
            // Initialize Shopify if not already done
            if (!shopifyEndpoint) {
                initializeShopify();
            }
            
            if (!shopifyEndpoint) {
                console.error('❌ Shopify not initialized');
                return [];
            }
            
            try {
                console.log('📦 Loading all Shopify products...');
                
                const query = `
                    query getProducts($first: Int!) {
                        products(first: $first) {
                            edges {
                                node {
                                    id
                                    title
                                    handle
                                    description
                                    productType
                                    tags
                                    priceRange {
                                        minVariantPrice {
                                            amount
                                            currencyCode
                                        }
                                    }
                                    images(first: 5) {
                                        edges {
                                            node {
                                                url
                                                altText
                                            }
                                        }
                                    }
                                    variants(first: 1) {
                                        edges {
                                            node {
                                                availableForSale
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                `;

                const response = await fetch(shopifyEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                    },
                    body: JSON.stringify({
                        query: query,
                        variables: { first: 20 }
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.errors) {
                    return [];
                }

                if (data.data && data.data.products) {
                    const products = data.data.products.edges.map(edge => edge.node);
                    return products;
                }

                return [];
            } catch (error) {
                return [];
            }
        }

        // Also load Shopify products immediately if no Firebase
        if (!window.firebaseReady) {
            loadShopifyProducts();
        }

        // Function to refresh form language when site language changes
        function refreshFormLanguage() {
            populateWilayas();
            updateDairas();
        }

        // Language dropdown functionality
        const languageToggle = document.getElementById('language-toggle');
        const languageDropdown = document.getElementById('language-dropdown');
        const languageToggleMobile = document.getElementById('language-toggle-mobile');
        const languageDropdownMobile = document.getElementById('language-dropdown-mobile');

        if (languageToggle && languageDropdown) {
            languageToggle.addEventListener('click', (e) => {
                e.stopPropagation();
                languageDropdown.classList.toggle('hidden');
                if (languageDropdownMobile) languageDropdownMobile.classList.add('hidden');
            });
        }

        if (languageToggleMobile && languageDropdownMobile) {
            languageToggleMobile.addEventListener('click', (e) => {
                e.stopPropagation();
                languageDropdownMobile.classList.toggle('hidden');
                if (languageDropdown) languageDropdown.classList.add('hidden');
            });
        }

        // Language selection
        document.querySelectorAll('.lang-option').forEach(button => {
            button.addEventListener('click', (e) => {
                const selectedLang = e.target.getAttribute('data-lang');
                const langCode = selectedLang.toUpperCase();

                // Update language display
                document.querySelectorAll('#language-toggle span, #language-toggle-mobile span').forEach(span => {
                    span.textContent = langCode;
                });

                // Set document language and direction
                document.documentElement.lang = selectedLang;
                if (selectedLang === 'ar') {
                    document.documentElement.dir = 'rtl';
                } else {
                    document.documentElement.dir = 'ltr';
                }

                // Update all elements with data-lang attributes
                document.querySelectorAll('[data-lang]').forEach(element => {
                    const text = element.getAttribute(`data-${selectedLang}`);
                    if (text) {
                        element.textContent = text;
                    }
                });

                // Refresh form language if modal is open
                if (document.getElementById('orderModal').style.display === 'flex') {
                    refreshFormLanguage();
                }

                // Close dropdowns
                if (languageDropdown) languageDropdown.classList.add('hidden');
                if (languageDropdownMobile) languageDropdownMobile.classList.add('hidden');
            });
        });

        // Close dropdowns when clicking outside
        window.addEventListener('click', (e) => {
            if (languageDropdown && !e.target.closest('#language-toggle') && !e.target.closest('#language-dropdown')) {
                languageDropdown.classList.add('hidden');
            }
            if (languageDropdownMobile && !e.target.closest('#language-toggle-mobile') && !e.target.closest('#language-dropdown-mobile')) {
                languageDropdownMobile.classList.add('hidden');
            }
        });

        // Shopify Integration - Initialize at the top
        let shopifyAccessToken, shopDomain, shopifyEndpoint;
        
        // Initialize Shopify variables when config is available
        function initializeShopify() {
            if (window.config && window.config.shopify) {
                shopifyAccessToken = window.config.shopify.accessToken;
                shopDomain = window.config.shopify.domain;
                shopifyEndpoint = `https://${shopDomain}/api/2024-01/graphql.json`;
                console.log('✅ Shopify variables initialized');
            } else {
                console.warn('⚠️ Shopify config not available');
            }
        }

        // Comprehensive Shopify diagnostic function
        async function diagnoseShopifyIssues() {
            // Test 1: Check configuration
            // Test 2: Basic connectivity
            try {
                const response = await fetch(shopifyEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                    },
                    body: JSON.stringify({
                        query: `query { shop { name } }`
                    })
                });
                
                const data = await response.json();
                
                if (data.errors) {
                    // Handle errors silently
                } else if (data.data && data.data.shop) {
                    // Connection successful
                }
                
            } catch (error) {
                // Handle errors silently
            }
            
            // Test 3: Try different API versions
            const apiVersions = ['2024-01', '2023-10', '2023-07', '2023-04'];
            
            for (const version of apiVersions) {
                try {
                    const testEndpoint = `https://${shopDomain}/api/${version}/graphql.json`;
                    
                    const response = await fetch(testEndpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                        },
                        body: JSON.stringify({
                            query: `query { shop { name } }`
                        })
                    });
                    
                    if (response.ok) {
                        break;
                    }
                } catch (error) {
                    // Handle errors silently
                }
            }
        }

        // Test Shopify connection on page load
        async function testShopifyConnection() {
            const statusDiv = document.getElementById('shopify-status');
            const statusIcon = document.getElementById('status-icon');
            const statusText = document.getElementById('status-text');
            
            if (statusDiv) {
                statusDiv.style.display = 'block';
                statusIcon.textContent = '🔍';
                statusText.textContent = 'Testing Shopify connection...';
            }
            
            try {
                const testQuery = `
                    query {
                        shop {
                            name
                            primaryDomain {
                                url
                            }
                        }
                    }
                `;

                const response = await fetch(shopifyEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                    },
                    body: JSON.stringify({
                        query: testQuery
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                if (data.errors) {
                    if (statusDiv) {
                        statusIcon.textContent = '❌';
                        statusText.textContent = 'Shopify connection failed - API errors';
                    }
                    return false;
                }

                if (data.data && data.data.shop) {
                    if (statusDiv) {
                        statusIcon.textContent = '✅';
                        statusText.textContent = `Connected to ${data.data.shop.name}`;
                    }
                    return true;
                }

                if (statusDiv) {
                    statusIcon.textContent = '❌';
                    statusText.textContent = 'Shopify connection failed - No shop data';
                }
                return false;
            } catch (error) {
                if (statusDiv) {
                    statusIcon.textContent = '❌';
                    statusText.textContent = `Connection failed: ${error.message}`;
                }
                return false;
            }
        }



        // Load product from Shopify
        async function loadShopifyProduct(handle) {
            try {
                
                const query = `
                    query getProduct($handle: String!) {
                        product(handle: $handle) {
                            id
                            title
                            handle
                            description
                            productType
                            tags
                            priceRange {
                                minVariantPrice {
                                    amount
                                    currencyCode
                                }
                                maxVariantPrice {
                                    amount
                                    currencyCode
                                }
                            }
                            images(first: 10) {
                                edges {
                                    node {
                                        url
                                        altText
                                    }
                                }
                            }
                            variants(first: 10) {
                                edges {
                                    node {
                                        id
                                        title
                                        availableForSale
                                        price {
                                            amount
                                            currencyCode
                                        }
                                    }
                                }
                            }
                            options {
                                name
                                values
                            }
                        }
                    }
                `;

                console.log('Sending GraphQL query to Shopify...');
                const response = await fetch(shopifyEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                    },
                    body: JSON.stringify({
                        query: query,
                        variables: { handle: handle }
                    })
                });

                console.log('Shopify response status:', response.status);
                console.log('Shopify response headers:', response.headers);

                if (!response.ok) {
                    console.error('Shopify HTTP error:', response.status, response.statusText);
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log('Shopify API response data:', data);
                
                if (data.errors) {
                    console.error('Shopify API errors:', data.errors);
                    data.errors.forEach((error, index) => {
                        console.error(`Error ${index + 1}:`, error.message);
                        console.error('Error locations:', error.locations);
                        console.error('Error path:', error.path);
                    });
                    return null;
                }

                if (data.data && data.data.product) {
                    console.log('✅ Product loaded from Shopify:', data.data.product);
                    return data.data.product;
                } else {
                    console.log('❌ No product data found in response');
                    return null;
                }

                return null;
            } catch (error) {
                console.error('❌ Error loading product from Shopify:', error);
                console.error('Error details:', {
                    message: error.message,
                    name: error.name,
                    stack: error.stack
                });
                return null;
            }
        }

        // Update product display with Shopify data
        function updateProductDisplay(product) {
            // Update product title
            const titleElement = document.querySelector('.product-title');
            if (titleElement) {
                titleElement.textContent = product.title;
            }

            // Update product price
            const priceElement = document.querySelector('.price');
            if (priceElement && product.priceRange) {
                const minPrice = product.priceRange.minVariantPrice;
                const maxPrice = product.priceRange.maxVariantPrice;
                
                if (minPrice && maxPrice && minPrice.amount !== maxPrice.amount) {
                    priceElement.innerHTML = `${minPrice.currencyCode} ${minPrice.amount} - ${maxPrice.currencyCode} ${maxPrice.amount}`;
                } else if (minPrice) {
                    priceElement.innerHTML = `${minPrice.currencyCode} ${minPrice.amount}`;
                }
            }

            // Update product images
            if (product.images && product.images.edges.length > 0) {
                const images = product.images.edges.map(edge => edge.node);
                
                // Update main image
                const mainImage = document.querySelector('.main-image');
                if (mainImage && images[0]) {
                    mainImage.src = images[0].url;
                    mainImage.alt = images[0].altText || product.title;
                }

                // Update mobile slider images
                const sliderTrack = document.querySelector('.slider-track');
                if (sliderTrack) {
                    sliderTrack.innerHTML = images.map((image, index) => `
                        <div class="slide ${index === 0 ? 'active' : ''}">
                            <img src="${image.url}" alt="${image.altText || product.title}" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                        </div>
                    `).join('');
                }

                // Update thumbnails
                const thumbnailContainer = document.querySelector('.thumbnail-images');
                if (thumbnailContainer) {
                    thumbnailContainer.innerHTML = images.map((image, index) => `
                        <img src="${image.url}" alt="${image.altText || product.title}" class="thumbnail ${index === 0 ? 'active' : ''}">
                    `).join('');
                }

                // Update slider dots
                const dotsContainer = document.querySelector('.slider-dots');
                if (dotsContainer) {
                    dotsContainer.innerHTML = images.map((_, index) => `
                        <span class="dot ${index === 0 ? 'active' : ''}" data-slide="${index}"></span>
                    `).join('');
                }
            }

            // Update product description
            const detailsTab = document.getElementById('details');
            if (detailsTab && product.description) {
                const descriptionElement = detailsTab.querySelector('p');
                if (descriptionElement) {
                    descriptionElement.textContent = product.description;
                }
            }

            // Update stock status
            const stockElement = document.querySelector('.stock-status');
            if (stockElement && product.variants) {
                const availableVariants = product.variants.edges.filter(edge => edge.node.availableForSale);
                if (availableVariants.length > 0) {
                    stockElement.textContent = 'In Stock';
                    stockElement.style.color = '#28a745';
                } else {
                    stockElement.textContent = 'Out of Stock';
                    stockElement.style.color = '#dc3545';
                }
            }

            // Generate features from product data
            const featuresList = document.getElementById('dynamic-features');
            if (featuresList) {
                const features = [];
                
                if (product.productType) {
                    features.push(`Product Type: ${product.productType}`);
                }
                
                if (product.tags && product.tags.length > 0) {
                    features.push(`Tags: ${product.tags.join(', ')}`);
                }
                
                if (product.options && product.options.length > 0) {
                    product.options.forEach(option => {
                        features.push(`${option.name}: ${option.values.join(', ')}`);
                    });
                }
                
                if (features.length > 0) {
                    featuresList.innerHTML = features.map(feature => `<li>${feature}</li>`).join('');
                } else {
                    featuresList.innerHTML = '<li>Product details available upon request</li>';
                }
            }

            // Generate specifications from product data
            const specsTable = document.getElementById('dynamic-specs');
            if (specsTable) {
                const specs = [];
                
                if (product.productType) {
                    specs.push({ category: 'Product Type', value: product.productType });
                }
                
                if (product.tags && product.tags.length > 0) {
                    specs.push({ category: 'Tags', value: product.tags.join(', ') });
                }
                
                if (product.variants && product.variants.edges.length > 0) {
                    const variantCount = product.variants.edges.length;
                    specs.push({ category: 'Available Variants', value: variantCount.toString() });
                }
                
                if (product.options && product.options.length > 0) {
                    product.options.forEach(option => {
                        specs.push({ category: option.name, value: option.values.join(', ') });
                    });
                }
                
                if (specs.length > 0) {
                    specsTable.innerHTML = specs.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
                } else {
                    specsTable.innerHTML = '<tr><td colspan="2">Specifications available upon request</td></tr>';
                }
            }
        }

        // Fallback to Firebase data loading
        async function loadFirebaseProductData(productHandle) {
            try {
                const featuresDocRef = window.doc(window.db, 'productFeatures', productHandle);
                const specsDocRef = window.doc(window.db, 'productSpecs', productHandle);

                const featuresDoc = await window.getDoc(featuresDocRef);
                const specsDoc = await window.getDoc(specsDocRef);

                // Load Key Features
                const featuresList = document.getElementById('dynamic-features');
                if (featuresDoc.exists()) {
                    const features = featuresDoc.data().features || [];
                    if (features.length > 0) {
                        featuresList.innerHTML = features.map(feature => `<li>${feature.text || feature}</li>`).join('');
                    } else {
                        // Fallback features for premium smartphone
                        const fallbackFeatures = [
                            'Advanced AI-powered camera system',
                            '5G connectivity for ultra-fast internet',
                            'Long-lasting battery with fast charging',
                            'Premium build quality with durable materials',
                            'High-resolution display with HDR support',
                            'Advanced security features with biometric authentication'
                        ];
                        featuresList.innerHTML = fallbackFeatures.map(feature => `<li>${feature}</li>`).join('');
                    }
                } else {
                    // Default features when no Firebase data
                    const defaultFeatures = [
                        'High-performance processor for smooth multitasking',
                        'Professional-grade camera with multiple lenses',
                        'All-day battery life with fast charging',
                        'Premium design with premium materials',
                        'Advanced security with fingerprint and face recognition',
                        '5G ready for future network compatibility'
                    ];
                    featuresList.innerHTML = defaultFeatures.map(feature => `<li>${feature}</li>`).join('');
                }

                // Load Specifications
                const specsTable = document.getElementById('dynamic-specs');
                if (specsDoc.exists()) {
                    const specifications = specsDoc.data().specifications || [];
                    if (specifications.length > 0) {
                        specsTable.innerHTML = specifications.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
                    } else {
                        // Fallback specifications
                        const fallbackSpecs = [
                            { category: 'Display', value: '6.7-inch OLED, 120Hz refresh rate' },
                            { category: 'Processor', value: 'Advanced AI chip with neural engine' },
                            { category: 'Storage', value: '128GB/256GB/512GB options' },
                            { category: 'RAM', value: '8GB LPDDR5' },
                            { category: 'Camera', value: 'Triple camera system with 48MP main sensor' },
                            { category: 'Battery', value: '4500mAh with 65W fast charging' },
                            { category: 'Connectivity', value: '5G, Wi-Fi 6E, Bluetooth 5.3' },
                            { category: 'Security', value: 'Fingerprint sensor, Face recognition' }
                        ];
                        specsTable.innerHTML = fallbackSpecs.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
                    }
                } else {
                    // Default specifications when no Firebase data
                    const defaultSpecs = [
                        { category: 'Display', value: '6.1-inch Super AMOLED, 90Hz' },
                        { category: 'Processor', value: 'Octa-core with AI acceleration' },
                        { category: 'Storage', value: '128GB internal, expandable' },
                        { category: 'RAM', value: '6GB/8GB options' },
                        { category: 'Camera', value: 'Quad camera setup with 64MP main' },
                        { category: 'Battery', value: '4000mAh with 25W charging' },
                        { category: 'Connectivity', value: '4G LTE, Wi-Fi 5, Bluetooth 5.0' },
                        { category: 'Security', value: 'Side-mounted fingerprint sensor' }
                    ];
                    specsTable.innerHTML = defaultSpecs.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
                }
            } catch (error) {
                // Handle Firebase errors gracefully with default data
                const featuresList = document.getElementById('dynamic-features');
                const specsTable = document.getElementById('dynamic-specs');
                
                // Default features
                const defaultFeatures = [
                    'High-performance processor for smooth multitasking',
                    'Professional-grade camera with multiple lenses',
                    'All-day battery life with fast charging',
                    'Premium design with premium materials',
                    'Advanced security with fingerprint and face recognition',
                    '5G ready for future network compatibility'
                ];
                featuresList.innerHTML = defaultFeatures.map(feature => `<li>${feature}</li>`).join('');
                
                // Default specifications
                const defaultSpecs = [
                    { category: 'Display', value: '6.1-inch Super AMOLED, 90Hz' },
                    { category: 'Processor', value: 'Octa-core with AI acceleration' },
                    { category: 'Storage', value: '128GB internal, expandable' },
                    { category: 'RAM', value: '6GB/8GB options' },
                    { category: 'Camera', value: 'Quad camera setup with 64MP main' },
                    { category: 'Battery', value: '4000mAh with 25W charging' },
                    { category: 'Connectivity', value: '4G LTE, Wi-Fi 5, Bluetooth 5.0' },
                    { category: 'Security', value: 'Side-mounted fingerprint sensor' }
                ];
                specsTable.innerHTML = defaultSpecs.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
            }
        }

        // Sample product data for when Shopify product is not found
        function loadSampleProductData(handle) {
            
            const sampleProducts = {
                'test': {
                    title: "iPhone 15 Pro Max - Test Product",
                    description: "Experience the future of mobile technology with the iPhone 15 Pro Max. Featuring the revolutionary A17 Pro chip, titanium design, and an advanced camera system that captures stunning photos and videos in any lighting condition.",
                    price: "1199.00",
                    currency: "USD",
                    images: [
                        "https://placehold.co/600x600?text=iPhone+15+Pro+Max+1",
                        "https://placehold.co/600x600?text=iPhone+15+Pro+Max+2",
                        "https://placehold.co/600x600?text=iPhone+15+Pro+Max+3",
                        "https://placehold.co/600x600?text=iPhone+15+Pro+Max+4"
                    ],
                    available: true,
                    features: [
                        "A17 Pro chip with 6-core GPU",
                        "Titanium design with Ceramic Shield",
                        "48MP Main camera with 2x Telephoto",
                        "5x Telephoto camera with 120mm focal length",
                        "Action button for quick access",
                        "USB-C connector",
                        "Up to 29 hours video playback"
                    ],
                    specs: [
                        { category: "Display", value: "6.7-inch Super Retina XDR display" },
                        { category: "Chip", value: "A17 Pro chip with 6-core GPU" },
                        { category: "Storage", value: "256GB, 512GB, 1TB" },
                        { category: "Camera", value: "48MP Main + 12MP Ultra Wide + 5x Telephoto" },
                        { category: "Battery", value: "Up to 29 hours video playback" },
                        { category: "Connectivity", value: "5G, Wi-Fi 6E, Bluetooth 5.3" }
                    ]
                },
                'default-product': {
                    title: "Premium Smartphone X1",
                    description: "Experience cutting-edge technology with our latest Premium Smartphone X1 that combines elegant design with powerful performance. This device features a premium build quality with an immersive display, advanced camera system for stunning photos, and all-day battery life to keep you connected.",
                    price: "899.99",
                    currency: "USD",
                    images: [
                        "https://placehold.co/600x600?text=Premium+Smartphone+X1+1",
                        "https://placehold.co/600x600?text=Premium+Smartphone+X1+2",
                        "https://placehold.co/600x600?text=Premium+Smartphone+X1+3",
                        "https://placehold.co/600x600?text=Premium+Smartphone+X1+4"
                    ],
                    available: true,
                    features: [
                        "6.7-inch OLED display with 120Hz refresh rate",
                        "Latest Snapdragon processor",
                        "Triple camera system with 108MP main sensor",
                        "5000mAh battery with 65W fast charging",
                        "5G connectivity",
                        "In-display fingerprint sensor",
                        "Wireless charging support"
                    ],
                    specs: [
                        { category: "Display", value: "6.7-inch OLED, 120Hz" },
                        { category: "Processor", value: "Snapdragon 8 Gen 2" },
                        { category: "RAM", value: "8GB/12GB LPDDR5X" },
                        { category: "Storage", value: "128GB/256GB/512GB UFS 4.0" },
                        { category: "Camera", value: "108MP + 12MP + 10MP" },
                        { category: "Battery", value: "5000mAh, 65W charging" }
                    ]
                }
            };
            
            const product = sampleProducts[handle] || sampleProducts['default-product'];
            updateProductDisplayWithSampleData(product);
        }

        // Update product display with sample data
        function updateProductDisplayWithSampleData(product) {
            console.log('🎨 Updating display with sample product:', product.title);
            
            // Update product title
            const titleElement = document.querySelector('.product-title');
            if (titleElement) {
                titleElement.textContent = product.title;
            }

            // Update product price
            const priceElement = document.querySelector('.price');
            if (priceElement) {
                priceElement.innerHTML = `${product.currency} ${product.price}`;
            }

            // Update product images
            if (product.images && product.images.length > 0) {
                // Update main image
                const mainImage = document.querySelector('.main-image');
                if (mainImage) {
                    mainImage.src = product.images[0];
                    mainImage.alt = product.title;
                }

                // Update mobile slider images
                const sliderTrack = document.querySelector('.slider-track');
                if (sliderTrack) {
                    sliderTrack.innerHTML = product.images.map((image, index) => `
                        <div class="slide ${index === 0 ? 'active' : ''}">
                            <img src="${image}" alt="${product.title}" class="slide-image w-full h-auto max-w-full mx-auto rounded-lg shadow">
                        </div>
                    `).join('');
                }

                // Update thumbnails
                const thumbnailContainer = document.querySelector('.thumbnail-images');
                if (thumbnailContainer) {
                    thumbnailContainer.innerHTML = product.images.map((image, index) => `
                        <img src="${image}" alt="${product.title}" class="thumbnail ${index === 0 ? 'active' : ''}">
                    `).join('');
                }

                // Update slider dots
                const dotsContainer = document.querySelector('.slider-dots');
                if (dotsContainer) {
                    dotsContainer.innerHTML = product.images.map((_, index) => `
                        <span class="dot ${index === 0 ? 'active' : ''}" data-slide="${index}"></span>
                    `).join('');
                }
            }

            // Update product description
            const detailsTab = document.getElementById('details');
            if (detailsTab && product.description) {
                const descriptionElement = detailsTab.querySelector('p');
                if (descriptionElement) {
                    descriptionElement.textContent = product.description;
                }
            }

            // Update stock status
            const stockElement = document.querySelector('.stock-status');
            if (stockElement) {
                if (product.available) {
                    stockElement.textContent = 'In Stock';
                    stockElement.style.color = '#28a745';
                } else {
                    stockElement.textContent = 'Out of Stock';
                    stockElement.style.color = '#dc3545';
                }
            }

            // Update features
            const featuresList = document.getElementById('dynamic-features');
            if (featuresList && product.features) {
                featuresList.innerHTML = product.features.map(feature => `<li>${feature}</li>`).join('');
            }

            // Update specifications
            const specsTable = document.getElementById('dynamic-specs');
            if (specsTable && product.specs) {
                specsTable.innerHTML = product.specs.map(spec => `<tr><th>${spec.category}</th><td>${spec.value}</td></tr>`).join('');
            }
        }

        // Fallback function to load sample products when Shopify fails
        function loadSampleProducts() {
            console.log('📦 Loading sample products as fallback...');
            
            const sampleProducts = [
                {
                    title: "iPhone 15 Pro Max",
                    handle: "iphone-15-pro-max",
                    description: "The most advanced iPhone ever with A17 Pro chip, titanium design, and pro camera system.",
                    price: "1199.00",
                    currency: "USD",
                    image: "https://placehold.co/400x400?text=iPhone+15+Pro+Max",
                    available: true
                },
                {
                    title: "Samsung Galaxy S24 Ultra",
                    handle: "samsung-galaxy-s24-ultra",
                    description: "Revolutionary AI features with S Pen, 200MP camera, and titanium frame.",
                    price: "1299.99",
                    currency: "USD",
                    image: "https://placehold.co/400x400?text=Galaxy+S24+Ultra",
                    available: true
                },
                {
                    title: "Google Pixel 8 Pro",
                    handle: "google-pixel-8-pro",
                    description: "Best-in-class camera with AI-powered features and Google's latest innovations.",
                    price: "999.00",
                    currency: "USD",
                    image: "https://placehold.co/400x400?text=Pixel+8+Pro",
                    available: true
                },
                {
                    title: "OnePlus 12",
                    handle: "oneplus-12",
                    description: "Fast and smooth performance with Hasselblad camera and 100W charging.",
                    price: "799.99",
                    currency: "USD",
                    image: "https://placehold.co/400x400?text=OnePlus+12",
                    available: false
                }
            ];
            
            displayRelatedProducts(sampleProducts);
        }

        // Load related products from Shopify
        async function loadRelatedProducts(currentProductHandle) {
            try {
                console.log('📦 Loading related products from Shopify...');
                
                const query = `
                    query getProducts($first: Int!) {
                        products(first: $first) {
                            edges {
                                node {
                                    id
                                    title
                                    handle
                                    description
                                    productType
                                    priceRange {
                                        minVariantPrice {
                                            amount
                                            currencyCode
                                        }
                                    }
                                    images(first: 1) {
                                        edges {
                                            node {
                                                url
                                                altText
                                            }
                                        }
                                    }
                                    variants(first: 1) {
                                        edges {
                                            node {
                                                availableForSale
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                `;

                const response = await fetch(shopifyEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': shopifyAccessToken
                    },
                    body: JSON.stringify({
                        query: query,
                        variables: { first: 8 }
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                if (data.errors) {
                    console.error('Shopify API errors:', data.errors);
                    // Load sample products as fallback
                    loadSampleProducts();
                    return;
                }

                if (data.data && data.data.products) {
                    const products = data.data.products.edges
                        .map(edge => edge.node)
                        .filter(product => product.handle !== currentProductHandle) // Exclude current product
                        .slice(0, 4); // Show max 4 related products
                    
                    displayRelatedProducts(products);
                } else {
                    // Load sample products as fallback
                    loadSampleProducts();
                }
            } catch (error) {
                console.error('❌ Error loading related products:', error);
                // Load sample products as fallback
                loadSampleProducts();
            }
        }

        // Display related products
        function displayRelatedProducts(products) {
            const relatedGrid = document.getElementById('related-products-grid');
            if (!relatedGrid) return;

            if (products.length === 0) {
                relatedGrid.innerHTML = `
                    <div class="col-span-full text-center py-8">
                        <div class="text-gray-500 dark:text-gray-400">
                            <i class="fas fa-box-open text-4xl mb-4"></i>
                            <p class="text-lg">No related products found</p>
                        </div>
                    </div>
                `;
                return;
            }

            relatedGrid.innerHTML = products.map(product => {
                // Handle both Shopify and sample products
                let price, currency, image, isAvailable, description;
                
                if (product.priceRange) {
                    // Shopify product format
                    price = product.priceRange?.minVariantPrice?.amount || '0';
                    currency = product.priceRange?.minVariantPrice?.currencyCode || 'USD';
                    image = product.images?.edges[0]?.node || { url: 'https://placehold.co/300x200', altText: product.title };
                    isAvailable = product.variants?.edges[0]?.node?.availableForSale || false;
                    description = product.description;
                } else {
                    // Sample product format
                    price = product.price;
                    currency = product.currency;
                    image = { url: product.image, altText: product.title };
                    isAvailable = product.available;
                    description = product.description;
                }
                
                return `
                    <div class="product-card">
                        <img src="${image.url}" alt="${image.altText || product.title}" 
                             class="w-full h-48 object-cover"
                             onerror="this.src='https://placehold.co/300x200?text=No+Image'">
                        <div class="product-card-content">
                            <h3>${product.title}</h3>
                            <div class="price">${currency} ${price}</div>
                            <div class="rating">★★★★☆ 4.5</div>
                            <p>${description ? description.substring(0, 100) + '...' : 'Product description available upon request'}</p>
                            <div class="actions">
                                <button class="btn-primary" onclick="viewProduct('${product.handle}')">
                                    ${isAvailable ? 'View Details' : 'Contact Us'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Show error for related products
        function showRelatedProductsError() {
            const relatedGrid = document.getElementById('related-products-grid');
            if (!relatedGrid) return;

            relatedGrid.innerHTML = `
                <div class="col-span-full text-center py-8">
                    <div class="text-red-500 dark:text-red-400">
                        <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                        <p class="text-lg">Failed to load related products</p>
                        <button onclick="loadRelatedProducts()" class="mt-4 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors">
                            Try Again
                        </button>
                    </div>
                </div>
            `;
        }

        // View product function
        function viewProduct(handle) {
            window.location.href = `product-in.html?product=${handle}`;
        }

        // Function to load and display Shopify products
        async function loadShopifyProducts() {
            const products = await loadAllShopifyProducts();
            
            if (products.length > 0) {
                // Display first product as main product
                const firstProduct = products[0];
                updateProductDisplay(firstProduct);
                
                // Display remaining products as related products
                const relatedProducts = products.slice(1, 5); // Show up to 4 related products
                displayRelatedProducts(relatedProducts);
                
                // Show success message
                const statusDiv = document.getElementById('shopify-status');
                if (statusDiv) {
                    statusDiv.style.display = 'block';
                    const statusIcon = document.getElementById('status-icon');
                    const statusText = document.getElementById('status-text');
                    if (statusIcon && statusText) {
                        statusIcon.textContent = '✅';
                        statusText.textContent = `Loaded ${products.length} products from Shopify`;
                    }
                }
            } else {
                // Show error message
                const statusDiv = document.getElementById('shopify-status');
                if (statusDiv) {
                    statusDiv.style.display = 'block';
                    const statusIcon = document.getElementById('status-icon');
                    const statusText = document.getElementById('status-text');
                    if (statusIcon && statusText) {
                        statusIcon.textContent = '❌';
                        statusText.textContent = 'No products found in Shopify store';
                    }
                }
            }
        }

        // Algerian provinces and districts data
        
        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Show/hide scroll to top button
        window.addEventListener('scroll', function() {
            const scrollButton = document.getElementById('scroll-to-top');
            if (scrollButton) {
                if (window.pageYOffset > 300) {
                    scrollButton.classList.add('show');
                } else {
                    scrollButton.classList.remove('show');
                }
            }
        });
        
        // Add smooth scrolling to all internal links
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
    <script src="lang.js" defer></script>
</body>
</html>