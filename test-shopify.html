<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopify Test - DH Phone</title>
    
    <!-- Tailwind CSS -->
    <script>
        // Suppress Tailwind CDN warning
        window.tailwind = { 
            config: { 
                darkMode: 'class',
                theme: {
                    extend: {}
                }
            } 
        };
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Shopify Configuration -->
    <script src="shopify-config.js"></script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-200 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8">Shopify Integration Test</h1>
        
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg">
            <h2 class="text-xl font-semibold mb-4">Configuration Status</h2>
            <div id="config-status" class="space-y-2">
                <div class="flex items-center">
                    <span class="w-4 h-4 rounded-full mr-2" id="config-indicator"></span>
                    <span id="config-text">Checking configuration...</span>
                </div>
            </div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg mt-6">
            <h2 class="text-xl font-semibold mb-4">Test Product Loading</h2>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Product ID:</label>
                    <input type="text" id="product-id" placeholder="Enter product ID" 
                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <button id="test-btn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                    Test Product Load
                </button>
                <div id="test-result" class="mt-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg hidden">
                    <h3 class="font-semibold mb-2">Test Result:</h3>
                    <pre id="result-text" class="text-sm overflow-auto"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test Shopify Configuration
        function testConfiguration() {
            const config = window.SHOPIFY_CONFIG || SHOPIFY_CONFIG;
            const indicator = document.getElementById('config-indicator');
            const text = document.getElementById('config-text');
            
            if (config.storeUrl && config.storeUrl !== 'your-store.myshopify.com' &&
                config.accessToken && config.accessToken !== 'your-access-token') {
                indicator.className = 'w-4 h-4 rounded-full mr-2 bg-green-500';
                text.textContent = `✅ Configuration OK - Store: ${config.storeUrl}`;
            } else {
                indicator.className = 'w-4 h-4 rounded-full mr-2 bg-red-500';
                text.textContent = '❌ Configuration incomplete - Please check shopify-config.js';
            }
        }

        // Test Product Loading
        async function testProductLoad() {
            const productId = document.getElementById('product-id').value;
            const resultDiv = document.getElementById('test-result');
            const resultText = document.getElementById('result-text');
            
            if (!productId) {
                alert('Please enter a product ID');
                return;
            }
            
            resultDiv.classList.remove('hidden');
            resultText.textContent = 'Testing...';
            
            try {
                const config = window.SHOPIFY_CONFIG || SHOPIFY_CONFIG;
                
                const query = `
                    query getProduct($id: ID!) {
                        product(id: $id) {
                            id
                            title
                            description
                            handle
                            tags
                            images(first: 5) {
                                edges {
                                    node {
                                        id
                                        url
                                        altText
                                    }
                                }
                            }
                            variants(first: 5) {
                                edges {
                                    node {
                                        id
                                        title
                                        price {
                                            amount
                                            currencyCode
                                        }
                                        availableForSale
                                    }
                                }
                            }
                        }
                    }
                `;
                
                const response = await fetch(`https://${config.storeUrl}/api/${config.apiVersion}/graphql.json`, {
                    method: 'POST',
                    headers: {
                        'X-Shopify-Storefront-Access-Token': config.accessToken,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: query,
                        variables: {
                            id: `gid://shopify/Product/${productId}`
                        }
                    })
                });

                const data = await response.json();
                
                if (data.errors) {
                    resultText.textContent = `❌ Error: ${data.errors[0].message}`;
                } else if (data.data && data.data.product) {
                    resultText.textContent = `✅ Success!\n\nProduct: ${data.data.product.title}\nDescription: ${data.data.product.description}\nImages: ${data.data.product.images.edges.length}\nVariants: ${data.data.product.variants.edges.length}`;
                } else {
                    resultText.textContent = '❌ Product not found';
                }
                
            } catch (error) {
                resultText.textContent = `❌ Error: ${error.message}`;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            testConfiguration();
            
            document.getElementById('test-btn').addEventListener('click', testProductLoad);
        });
    </script>
</body>
</html> 